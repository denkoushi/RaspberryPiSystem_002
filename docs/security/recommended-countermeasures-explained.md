# 推奨セキュリティ対策の平易解説とユーザビリティ評価

最終更新: 2025-12-13

## 概要

本ドキュメントでは、アスクルランサムウェア攻撃への対応可否評価で推奨した3つの追加対策について、平易に解説し、ユーザビリティへの影響を評価します。

## 推奨対策1: MFA（多要素認証）の導入

### 平易な解説

**MFAとは**:
- 現在: パスワードだけ入力すればログインできる
- MFA導入後: パスワード + スマホアプリで表示される6桁の数字を入力する

**具体例**:
1. ユーザー名とパスワードを入力
2. スマホの認証アプリ（Google Authenticator、Microsoft Authenticator等）を開く
3. 画面に表示される6桁の数字を入力
4. ログイン完了

**なぜ安全なのか**:
- パスワードが漏洩しても、スマホがないとログインできない
- 6桁の数字は30秒ごとに変わるため、盗み見られてもすぐに無効になる

### ユーザビリティへの影響

| 項目 | 影響 | 評価 |
|------|------|------|
| **ログイン手順** | パスワード入力 + 6桁数字入力（約10秒追加） | ⚠️ **軽微な低下** |
| **必要な準備** | スマホに認証アプリをインストール（初回のみ） | ⚠️ **初回設定が必要** |
| **スマホ忘れ時** | バックアップコードでログイン可能（事前に印刷・保管） | ✅ **代替手段あり** |
| **日常的な操作** | ログイン時のみ追加手順（通常は1日1回程度） | ✅ **影響は限定的** |

**総合評価**: ⚠️ **ユーザビリティは軽微に低下するが、許容範囲内**

**理由**:
- ログインは1日1回程度で、追加手順は約10秒
- スマホは常に携帯しているため、忘れるリスクは低い
- バックアップコードにより、スマホ忘れ時も対応可能

**推奨実装**:
- 初回ログイン時にQRコードを表示し、スマホでスキャンして設定
- バックアップコードを10個生成し、印刷・保管を推奨
- 「このデバイスを30日間記憶する」オプションで利便性向上

---

## 推奨対策2: リアルタイム監視の強化

### 平易な解説

**リアルタイム監視とは**:
- 現在: 15分ごとにログをチェック（侵入から検知まで最大15分の遅れ）
- 強化後: 異常を検知したら即座にアラート（数秒以内に検知）

**監視する内容**:
1. **ファイルの変更**: 重要なファイルが勝手に変更されていないか
2. **プロセスの異常**: 怪しいプログラムが動いていないか
3. **ネットワーク通信**: 外部への不審な通信がないか

**具体例**:
- データベースファイルが突然変更された → 即座にアラート
- 見知らぬプログラムが動いている → 即座にアラート
- 外部サーバーへの大量通信 → 即座にアラート

### ユーザビリティへの影響

| 項目 | 影響 | 評価 |
|------|------|------|
| **通常の操作** | 影響なし（バックグラウンドで動作） | ✅ **影響なし** |
| **画面表示** | 影響なし（管理画面のアラート表示のみ） | ✅ **影響なし** |
| **パフォーマンス** | CPU/メモリ使用量が若干増加（5-10%程度） | ⚠️ **軽微な影響** |
| **アラート頻度** | 誤検知の可能性（設定調整が必要） | ⚠️ **初期設定が必要** |

**総合評価**: ✅ **ユーザビリティへの影響はほぼなし**

**理由**:
- バックグラウンドで動作するため、ユーザーの操作に影響しない
- アラートは管理画面に表示されるだけ（既存のアラート機能と同じ）
- Raspberry Pi 5のリソースであれば、5-10%の負荷増加は問題ない

**推奨実装**:
- 段階的な導入（まずファイル監視から開始）
- 誤検知を減らすための除外リスト設定
- アラートの重要度を3段階（Critical/High/Medium）に分類

---

## 推奨対策3: 権限監査の実装

### 平易な解説

**権限監査とは**:
- 現在: 誰がいつ権限を変更したか記録されていない
- 実装後: 権限変更の履歴が全て記録され、異常な変更を検知

**記録する内容**:
1. **誰が**: どのユーザーが権限を変更したか
2. **いつ**: いつ変更したか
3. **何を**: どのユーザーの権限を変更したか
4. **どう変更したか**: どの権限を追加・削除したか

**具体例**:
- 2025-12-13 14:30: 管理者AがユーザーBを「VIEWER」から「ADMIN」に変更
- 2025-12-13 15:00: 管理者Aが自分自身の権限を「ADMIN」から「MANAGER」に変更（異常）

**異常検知の例**:
- 短時間に複数のユーザーを管理者に昇格 → アラート
- 自分自身の権限を変更 → アラート
- 通常業務時間外の権限変更 → アラート

### ユーザビリティへの影響

| 項目 | 影響 | 評価 |
|------|------|------|
| **通常の操作** | 影響なし（権限変更時に自動記録） | ✅ **影響なし** |
| **画面表示** | 権限変更履歴ページを追加（任意で確認） | ✅ **新機能追加** |
| **権限変更手順** | 変更手順は同じ（記録が自動で追加されるだけ） | ✅ **影響なし** |
| **パフォーマンス** | データベースへの記録のみ（影響は無視できる） | ✅ **影響なし** |

**総合評価**: ✅ **ユーザビリティへの影響はなし（むしろ向上）**

**理由**:
- 権限変更の手順は変わらない（記録が自動で追加されるだけ）
- 権限変更履歴を確認できるため、透明性が向上
- 異常な変更を検知できるため、セキュリティが向上

**推奨実装**:
- 管理画面に「権限変更履歴」ページを追加
- 履歴の検索・フィルタリング機能
- 異常な変更パターンを検知するアラート

---

## 総合評価と推奨実装順序

### ユーザビリティへの影響まとめ

| 対策 | ユーザビリティへの影響 | セキュリティ向上度 | 優先度 |
|------|---------------------|-----------------|--------|
| **1. MFA導入** | ⚠️ 軽微な低下（ログイン時に10秒追加） | ⭐⭐⭐⭐⭐ 非常に高い | **最優先** |
| **2. リアルタイム監視** | ✅ ほぼ影響なし | ⭐⭐⭐⭐ 高い | 中優先度 |
| **3. 権限監査** | ✅ 影響なし（むしろ向上） | ⭐⭐⭐ 中程度 | 中優先度 |

### 推奨実装順序

1. **第1段階: MFA導入**（最優先）
   - ユーザビリティへの影響は軽微だが、セキュリティ向上が最も大きい
   - アスクル型攻撃の「認証情報窃取」リスクを大幅に低減

2. **第2段階: 権限監査の実装**（中優先度）
   - ユーザビリティへの影響がなく、実装も比較的容易
   - 透明性とセキュリティの両方が向上

3. **第3段階: リアルタイム監視の強化**（中優先度）
   - ユーザビリティへの影響はほぼないが、実装が複雑
   - 段階的な導入を推奨（まずファイル監視から）

### ユーザビリティ低下の最小化策

#### MFA導入時の配慮

1. **「このデバイスを30日間記憶する」オプション**
   - 同じPCからは30日間、MFAコード入力を省略可能
   - 日常的な操作の利便性を維持

2. **バックアップコードの提供**
   - スマホ忘れ・紛失時に使用可能な10個のコードを事前に生成
   - 印刷・保管を推奨

3. **段階的な導入**
   - まず管理者のみにMFAを必須化
   - 運用に慣れたら全ユーザーに拡大

#### リアルタイム監視導入時の配慮

1. **誤検知の最小化**
   - 除外リストを適切に設定（正常な操作は除外）
   - アラートの重要度を3段階に分類（Critical/High/Medium）

2. **パフォーマンスへの配慮**
   - Raspberry Pi 5のリソースを考慮した監視設定
   - 必要に応じて監視間隔を調整

## 結論

### ユーザビリティへの影響

**総合評価**: ⚠️ **軽微な低下（MFA導入時のみ）**

- **MFA導入**: ログイン時に約10秒の追加手順が必要（1日1回程度）
- **リアルタイム監視**: ユーザー操作への影響なし
- **権限監査**: ユーザー操作への影響なし（むしろ透明性が向上）

### 推奨事項

1. **MFA導入を最優先**（セキュリティ向上が最も大きい）
   - 「このデバイスを30日間記憶する」オプションで利便性を維持
   - バックアップコードでスマホ忘れ時も対応可能

2. **権限監査を次に実装**（ユーザビリティへの影響なし）
   - 透明性とセキュリティの両方が向上

3. **リアルタイム監視は段階的に導入**（実装が複雑）
   - まずファイル監視から開始
   - 誤検知を減らすための設定調整が必要

**最終評価**: 3つの対策を実装しても、**ユーザビリティの著しい低下はない**。MFA導入時の軽微な手順追加は、セキュリティ向上のメリットを考慮すれば許容範囲内。
