# セキュリティ対策プレゼンテーション資料
## ～アサヒビールのランサムウェア被害を踏まえた対策と評価～

**対象**: システム担当者・経営層  
**作成日**: 2025-12-05  
**更新日**: 2026-01-19

---

## スライド1: 表紙

# セキュリティ対策について
## Raspberry Pi NFC 持出返却システム

**～アサヒビールの被害から学ぶ、私たちのシステムは安全か？～**

2025年12月5日

---

## スライド2: アジェンダ

1. **アサヒビールの被害とは？** - 実際に何が起きたのか
2. **私たちのシステムはどうなっている？** - 今、どんな対策をしているか（6つの壁で守られている）
3. **同じことが起きる可能性は？** - リスクはどのくらいか
4. **今の対策で大丈夫？** - 防護できるかどうか
5. **もっと強くするには？** - 今後の改善点（ログの機密情報保護は実装完了）
6. **まとめ** - 結論と次のステップ

---

## スライド3: アサヒビールの被害とは？

### 2025年9月29日に起きたこと

**実際に起きた被害**:
- 🚨 **約191万件の個人情報が漏えいした可能性**
  - 例：お客様の名前、住所、電話番号などが外部に流出した可能性
- 🚨 **受注・出荷業務が完全に停止**
  - 注文を受けられない、商品を出荷できない状態が続いた
- 🚨 **コールセンターが使えなくなった**
  - お客様からの問い合わせに対応できない状態
- 🚨 **製品の供給や新商品の発売に影響**
  - ビールが店頭に並ばない、新商品の発売が遅れる

**何が起きたのか**:
- **ランサムウェア**という悪意のあるソフトウェアがシステムに侵入
- システム内のデータがすべて暗号化され、使えなくなった
- 業務が完全に停止し、大きな経済的損失が発生
- 個人情報が漏えいし、社会的な信用も失った

**私たちが学ぶべきこと**:
- 大企業でも被害を受ける可能性がある
- バックアップ（データのコピー）と復旧計画が重要
- 悪意のあるソフトウェアを早期に検知することが大切

---

## スライド4: 私たちのシステムはどうなっている？（1/2）

### ✅ 6つの壁で守っています（多層防御）

**家のセキュリティに例えると**:

| 層 | 対策 | 何をしているか | 実装状況 |
|---|---|---|---|
| **第1層** | ファイアウォール | 家の門番。必要な人だけを通す | ✅ 実装済み |
| **第2層** | HTTPS強制 | 通信を暗号化。盗み見を防ぐ | ✅ 実装済み |
| **第3層** | 侵入検知システム | 不審なアクセスを自動でブロック | ✅ 実装済み |
| **第4層** | ウイルス対策 | 毎日自動でウイルスをチェック | ✅ 実装済み |
| **第5層** | 監視・アラート | 異常があればすぐに知らせる | ✅ 実装済み |
| **第6層** | ログの機密情報保護 | ログに機密情報を出力しない | ✅ 実装済み（2026-01-18） |

**なぜ6層も必要なのか？**
- 1つの壁が破られても、他の壁が守ってくれる
- 例：門番が寝ていても、防犯カメラが監視している
- すべて自動で動くので、人のミスが起きにくい
- ログファイルが漏洩しても、認証キーが悪用されない（第6層）

---

## スライド5: 私たちのシステムはどうなっている？（2/2）

### ✅ もしもの時の備え（ランサムウェア対策）

**データのバックアップ（コピー）**:
- ✅ **暗号化バックアップ** - データを暗号化して安全に保存
  - 例：金庫に鍵をかけて保管するようなもの
- ✅ **復元テスト実施済み** - バックアップから復元できることを確認済み
  - 例：避難訓練をして、本当に避難できるか確認した
- ✅ **定期的にバックアップ** - データを失うリスクを最小限に

**ウイルス対策**:
- ✅ **毎日自動でウイルスチェック** - 3種類のウイルス対策ソフトで毎日チェック
  - ClamAV: 一般的なウイルスを検出
  - Trivy: システムの弱点を検出
  - rkhunter: 隠れた悪意のあるソフトを検出
- ✅ **異常があればすぐに知らせる** - ウイルスを見つけたら自動でアラート

**ネットワークの安全**:
- ✅ **安全な接続経路** - メンテナンス時は安全な経路で接続
- ✅ **アクセス制限** - 信頼できるネットワークからのみアクセス可能

**ログの機密情報保護**（2026-01-18追加）:
- ✅ **認証キーの保護** - ログに認証キーを出力しない（`[REDACTED]`に置換）
  - 例：日記に鍵の番号を書かないようにする
- ✅ **ログファイル漏洩対策** - ログファイルが漏洩しても、認証キーが悪用されない
- ✅ **自動フィルタリング** - ログ出力時に自動的に機密情報をフィルタリング

---

## スライド6: 同じことが起きる可能性は？

### アサヒビールと私たちのシステムを比較

| 項目 | アサヒビール | 私たちのシステム | リスク |
|---|---|---|---|
| **インターネット公開** | 世界中からアクセス可能 | 工場内のネットワークのみ | 🟢 **非常に低い** |
| **外部からの攻撃** | 誰でも攻撃できる状態 | メンテナンス時のみ安全な経路で接続 | 🟢 **非常に低い** |
| **バックアップ** | 不十分だった可能性 | 暗号化 + 復元テスト済み | 🟢 **対策済み** |
| **ウイルス検知** | 不十分だった可能性 | 毎日自動チェック + 自動通知 | 🟢 **対策済み** |
| **データ規模** | 191万件の個人情報 | 工具管理データのみ（小規模） | 🟢 **影響が小さい** |
| **業務への影響** | 受注・出荷が停止 | 工具管理システムのみ | 🟢 **影響範囲が限定的** |

### 結論: **アサヒビールのような被害に遭う可能性は極めて低い** ✅

**なぜ安全と言えるのか？**

1. **インターネットに直接つながっていない**
   - アサヒビール: 世界中からアクセス可能な状態
   - 私たち: 工場内のネットワークのみ。外部からは見えない

2. **データの規模が小さい**
   - アサヒビール: 191万件の個人情報
   - 私たち: 工具管理データのみ。個人情報は扱っていない

3. **6つの壁で守られている**
   - アサヒビール: 防御が不十分だった可能性
   - 私たち: 6層の防御機構で守られている（2026-01-18にログの機密情報保護を追加）

---

## スライド7: 今の対策で大丈夫？

### もし攻撃されたら、どうなる？

| 攻撃の種類 | アサヒビール | 私たちの対策 | 結果 |
|---|---|---|---|
| **外部からの侵入** | インターネット経由で攻撃 | ファイアウォール + 侵入検知 + 暗号化通信 | ✅ **防げる** |
| **ランサムウェア感染** | システムが暗号化された | 毎日自動でウイルスチェック | ✅ **早期に発見できる** |
| **データが使えなくなった** | バックアップが不十分だった | 暗号化バックアップ + 復元テスト済み | ✅ **復旧できる** |
| **業務が止まった** | システムが完全停止 | バックアップから復元する手順が確立済み | ✅ **影響を最小限に** |
| **個人情報が漏れた** | 191万件が漏えい | 個人情報を扱っていない | ✅ **リスクが低い** |
| **ログファイルが漏洩した** | 認証キーが悪用される可能性 | ログに機密情報を出力しない（[REDACTED]に置換） | ✅ **対策済み**（2026-01-18） |
| **ログファイルが漏洩した** | 認証キーが悪用される可能性 | ログに機密情報を出力しない（[REDACTED]に置換） | ✅ **対策済み**（2026-01-18） |

### 結論: **今の対策で十分に防護できる** ✅

**なぜ防護できると言えるのか？**

1. **6つの壁で守られている**
   - 1つの壁が破られても、他の壁が守ってくれる
   - 例：玄関が開いても、部屋の鍵がかかっていれば大丈夫
   - 2026-01-18にログの機密情報保護（第6層）を追加

2. **すべて自動で動いている**
   - 人のミスが起きにくい
   - 毎日自動でウイルスチェック
   - ログ出力時に自動的に機密情報をフィルタリング

3. **バックアップから復旧できる**
   - もしデータが使えなくなっても、バックアップから復元できる
   - 復元テストを実施済みで、手順が確立されている

4. **異常があればすぐに知らせる**
   - ウイルスを見つけたら自動でアラート
   - 迅速に対応できる

---

## スライド8: アサヒビールから学ぶべきこと

### アサヒビールの失敗と、私たちの対策

| アサヒビールの失敗 | 私たちの対策 | 状況 |
|---|---|---|
| **バックアップが不十分だった** | 暗号化バックアップ + 復元テスト実施済み | ✅ **対策済み** |
| **ウイルスを早期に発見できなかった** | 毎日自動でウイルスチェック + 自動通知 | ✅ **対策済み** |
| **インターネットに公開されていた** | 工場内のネットワークのみ。外部からは見えない | ✅ **対策済み** |
| **防御が1つだけだった** | 6つの壁で守られている | ✅ **対策済み** |

### 結論: **アサヒビールの教訓は既に取り入れている** ✅

**アサヒビールの失敗から学んだこと**:
- バックアップは重要 → **私たちは暗号化バックアップ + 復元テスト済み**
- 早期発見が重要 → **私たちは毎日自動チェック + 自動通知**
- ネットワーク分離が重要 → **私たちは工場内ネットワークのみ**
- 多層防御が重要 → **私たちは6層の防御機構**（2026-01-18にログの機密情報保護を追加）

**つまり、アサヒビールが失敗した点は、すべて対策済みです**

---

## スライド9: もっと強くするには？

### 🔴 すぐにやるべきこと（必須）

1. **ログの機密情報保護** ✅ **実装完了（2026-01-18）**
   - **現状**: 認証キー（`x-client-key`）がログに平文で出力されていた
   - **問題**: ログファイルが漏洩した場合、認証キーが悪用される可能性がある
   - **対応**: ログ出力時に認証キーを`[REDACTED]`に置換するように実装
   - **効果**: ログファイルが漏洩しても、認証キーが悪用されない
   - **実装箇所**: リクエストロガー、キオスクAPI、工具管理API、WebRTCシグナリングなど6箇所を修正
   - **検証**: CIテスト成功、デプロイ成功、ログ確認完了

2. **USBメモリへのバックアップテスト**
   - **現状**: バックアップの暗号化・復元は確認済み
   - **不足**: USBメモリへの実際のコピー/削除テストは未実施
   - **対応**: USBメモリを接続した時にテストする予定
   - **効果**: ランサムウェア対策が完璧になる

### 🟡 できればやった方がいいこと（推奨）

3. **デフォルトパスワードの変更**（本番環境では必須）
   - **現状**: 管理ユーザー、PostgreSQL、JWTシークレットがデフォルト値のまま
   - **問題**: デフォルトパスワードが漏洩した場合、不正アクセスが可能になる
   - **対応**: 強力なパスワードに変更（管理画面から変更、または環境変数で設定）
   - **効果**: デフォルトパスワードによる不正アクセスを防止
   - **想定工数**: 0.5日

4. **Dockerコンテナの脆弱性チェック**
   - **現状**: ファイルのチェックは実施済み
   - **不足**: Dockerコンテナ内のチェックが不完全
   - **対応**: Dockerコンテナ単位のチェックを追加
   - **効果**: より多くの脆弱性を発見できる

5. **管理画面へのアクセス制限**
   - **現状**: 工場内ネットワークの誰でもアクセス可能
   - **不足**: 特定のPCからのみアクセスできるようにしていない
   - **対応**: 特定のPCからのみアクセス可能にする
   - **効果**: 不正アクセスのリスクをさらに下げる

### 🟢 将来的に検討すること

6. **CSRF対策の実装**
   - **現状**: CSRFトークンの実装が未確認
   - **不足**: SameSite Cookie属性の設定が未確認
   - **対応**: SameSite Cookie属性の設定、CSRFトークンの実装
   - **効果**: 認証済みユーザーが意図しない操作を実行されるリスクを低減
   - **想定工数**: 1-2日

7. **PostgreSQL SSL/TLS接続の強制**
   - **現状**: Docker内部ネットワークでのみアクセス可能だが、SSL/TLS接続が未強制
   - **不足**: より厳密な設定が推奨される
   - **対応**: PostgreSQLのSSL設定の有効化、クライアント接続でのSSL/TLS接続の強制
   - **効果**: Docker内部ネットワークでの通信傍受リスクを低減
   - **想定工数**: 1日

8. **スマートフォンへの通知**
   - **現状**: 管理画面でアラートを確認する必要がある
   - **不足**: リアルタイムでスマートフォンに通知されない
   - **対応**: Slack等を使ってスマートフォンに通知
   - **効果**: 異常をすぐに知ることができる

---

## スライド10: 私たちのシステムの強み

### アサヒビールと比べて、どこが強いか？

| 項目 | アサヒビール | 私たちのシステム | 強み |
|---|---|---|---|
| **ネットワーク** | 世界中からアクセス可能 | 工場内のみ | ✅ **攻撃されにくい** |
| **データ規模** | 191万件の個人情報 | 工具管理データのみ | ✅ **影響が小さい** |
| **バックアップ** | 不十分だった可能性 | 暗号化 + 復元テスト済み | ✅ **復旧できる** |
| **ウイルス検知** | 不十分だった可能性 | 毎日自動チェック + 自動通知 | ✅ **早期発見** |
| **防御の層** | 1層だけだった可能性 | 6層の防御 | ✅ **守りが堅い** |
| **自動化** | 手動だった可能性 | すべて自動 | ✅ **ミスが起きにくい** |

### 私たちのシステムの3つの強み

1. **インターネットに直接つながっていない**
   - アサヒビール: 世界中からアクセス可能 → 攻撃されやすい
   - 私たち: 工場内のネットワークのみ → 攻撃されにくい
   - 例：家の鍵をかけているのと、鍵をかけていない家の違い

2. **データの規模が小さい**
   - アサヒビール: 191万件の個人情報 → 漏えい時の影響が大きい
   - 私たち: 工具管理データのみ → 漏えい時の影響が小さい
   - 例：100万円を盗まれるのと、1万円を盗まれるのの違い

3. **6つの壁で守られている**
   - アサヒビール: 1つの壁だけ → 破られると終わり
   - 私たち: 6つの壁 → 1つ破られても他の壁が守る
   - 例：玄関だけ鍵をかけるのと、玄関・各部屋・金庫すべてに鍵をかけるのの違い
   - 2026-01-18にログの機密情報保護（第6層）を追加し、さらに堅牢に

---

## スライド11: もし攻撃されたら、どうなる？

### 3つのシナリオで考えてみましょう

#### シナリオ1: インターネットから攻撃されたら？
- **攻撃方法**: インターネット経由でシステムに侵入
- **私たちの対策**: インターネットに直接つながっていない → **攻撃できない** ✅
- **リスク**: **ほとんどゼロ**

**なぜ安全？**
- 工場内のネットワークのみで運用
- 外部からはシステムが見えない
- 例：家の住所を知られていないので、泥棒が来られない

#### シナリオ2: USBメモリから感染したら？
- **攻撃方法**: ウイルスが入ったUSBメモリを接続
- **私たちの対策**: 
  - 毎日自動でウイルスチェック → **すぐに発見できる** ✅
  - 異常があれば自動で通知 → **すぐに対応できる** ✅
- **リスク**: **低い（すぐに発見して対応できる）**

**なぜ安全？**
- 毎日自動でウイルスチェック
- 異常があればすぐに知らせる
- 例：防犯カメラが24時間監視しているので、すぐに気づける

#### シナリオ3: システムが暗号化されたら？
- **攻撃方法**: ランサムウェアでシステムが使えなくなった
- **私たちの対策**: 
  - 暗号化バックアップがある → **データを復旧できる** ✅
  - 復元テストを実施済み → **復旧手順が確立されている** ✅
- **リスク**: **低い（バックアップから復旧できる）**

**なぜ安全？**
- バックアップが暗号化されて安全に保管されている
- バックアップから復元する手順が確立されている
- 例：家が燃えても、保険に入っていて、再建の手順も分かっている

### 結論: **どのシナリオでも防護できる** ✅

---

## スライド12: コストはどのくらいかかる？

### セキュリティ対策にかかる費用

| 対策 | 費用 | 効果 | 費用対効果 |
|---|---|---|---|
| **ファイアウォール** | **無料** | 外部攻撃を防ぐ | ✅ **非常に高い** |
| **暗号化通信** | **無料** | 通信を盗み見から守る | ✅ **高い** |
| **ウイルス対策** | **無料** | ウイルスを早期発見 | ✅ **非常に高い** |
| **バックアップ暗号化** | **無料** | データを復旧できる | ✅ **非常に高い** |
| **監視・アラート** | **無料** | 異常をすぐに知らせる | ✅ **非常に高い** |
| **ログの機密情報保護** | **無料** | ログファイル漏洩時のリスクを低減 | ✅ **非常に高い** |

### 費用対効果の評価

**総費用**: **ほぼゼロ円**（すべて無料のソフトウェアを使用）  
**効果**: **非常に高い**（ランサムウェア対策として有効）

**結論**: **ほとんどお金をかけずに、最大限の効果を実現** ✅

**なぜ無料でできるのか？**
- すべて無料のオープンソースソフトウェア（OSS）を使用
- 追加のライセンス費用は一切かからない
- 例：有料のセキュリティソフトを買わなくても、無料のソフトで十分に守れる

---

## スライド13: 他の会社と比べてどう？

### 業界の標準と、私たちのシステムを比較

| 対策項目 | 業界の標準 | 私たちのシステム | 評価 |
|---|---|---|---|
| **ファイアウォール** | 必須 | ✅ 実装済み | ✅ **標準以上** |
| **暗号化通信** | 推奨 | ✅ 実装済み | ✅ **標準以上** |
| **侵入検知** | 推奨 | ✅ 実装済み | ✅ **標準以上** |
| **ウイルス対策** | 必須 | ✅ 3種類のソフトで実施 | ✅ **標準以上** |
| **バックアップ** | 必須 | ✅ 暗号化 + 復元テスト済み | ✅ **標準以上** |
| **監視・アラート** | 推奨 | ✅ 自動アラート実装 | ✅ **標準以上** |
| **ログの機密情報保護** | 推奨 | ✅ 認証キーを自動フィルタリング | ✅ **標準以上** |

### 結論: **業界の標準を満たし、一部で上回っている** ✅

**特に優れている点**:
- **6層の防御** - 業界標準は1-2層が多いが、私たちは6層（2026-01-18にログの機密情報保護を追加）
- **すべて自動** - 人のミスが起きにくい
- **バックアップの復元テスト済み** - 本当に復旧できることを確認済み
- **ログの機密情報保護** - ログファイル漏洩時のリスクを低減

**つまり、業界の標準以上の対策を実施しています**

---

## スライド14: まとめ - 結論

### 私たちのシステムのセキュリティ評価

#### ✅ **アサヒビールのような被害に遭う可能性は極めて低い**

**なぜ安全と言えるのか？**

1. **インターネットに直接つながっていない**
   - 工場内のネットワークのみで運用
   - 外部からはシステムが見えない

2. **6つの壁で守られている**
   - 1つの壁が破られても、他の壁が守る
   - すべて自動で動いている
   - 2026-01-18にログの機密情報保護（第6層）を追加

3. **バックアップから復旧できる**
   - 暗号化バックアップ + 復元テスト実施済み
   - もしデータが使えなくなっても復旧可能

4. **毎日自動でウイルスチェック**
   - 異常があればすぐに知らせる
   - 早期発見・早期対応ができる

5. **データの規模が小さい**
   - 個人情報を扱っていない
   - 影響範囲が限定的

#### ✅ **今の対策で十分に防護できる**

**根拠**:
- アサヒビールが失敗した点は、すべて対策済み
- 業界の標準以上の対策を実施
- ほとんどお金をかけずに、最大限の効果を実現

---

## スライド15: 今後の予定

### これからやること

#### ✅ 完了したこと（2026-01-18）
1. **ログの機密情報保護** ✅ **実装完了**
   - 認証キー（`x-client-key`）をログから除外し、`[REDACTED]`に置換
   - ログファイルが漏洩しても、認証キーが悪用されないように改善
   - CIテスト成功、デプロイ成功、ログ確認完了

#### 🔴 すぐにやること（1-2週間以内）
2. **USBメモリへのバックアップテスト**
   - USBメモリを接続した時に、バックアップが正しくコピーできるかテスト
   - ランサムウェア対策を完璧にする

3. **デフォルトパスワードの変更**（本番環境では必須）
   - 管理ユーザー、PostgreSQL、JWTシークレットのパスワードを強力なものに変更
   - デフォルトパスワードによる不正アクセスを防止

#### 🟡 できればやること（1-2ヶ月以内）
4. **管理画面へのアクセス制限**
   - 特定のPCからのみアクセスできるようにする
   - 不正アクセスのリスクをさらに下げる

5. **Dockerコンテナの脆弱性チェック**
   - Dockerコンテナ内もチェックする
   - より多くの脆弱性を発見できる

#### 🟢 将来的に検討すること
6. **CSRF対策の実装**
   - SameSite Cookie属性の設定、CSRFトークンの実装
   - 認証済みユーザーが意図しない操作を実行されるリスクを低減

7. **PostgreSQL SSL/TLS接続の強制**
   - PostgreSQLのSSL設定の有効化、クライアント接続でのSSL/TLS接続の強制
   - Docker内部ネットワークでの通信傍受リスクを低減

8. **スマートフォンへの通知**
   - 異常があればスマートフォンに通知
   - すぐに対応できる

### 現状の評価: **十分な機能を備えている** ✅

**基本的なセキュリティ対策はすべて実施済みです。アサヒビールのような大規模な被害に遭う可能性は極めて低いです。**

---

## スライド16: よくある質問

### Q&A

**Q1: アサヒビールのような大企業でも被害を受けたのに、なぜ私たちのシステムは安全と言えるのか？**

**A**: アサヒビールはインターネットに公開されていたため、世界中から攻撃されました。一方、私たちのシステムは工場内のネットワークのみで運用しており、インターネットに直接つながっていません。また、6つの壁で守られているため、1つの壁が破られても他の壁が守ってくれます（2026-01-18にログの機密情報保護を追加）。

**Q2: バックアップは本当に復旧できるのか？**

**A**: はい。実際にテストを実施して、バックアップからデータを復元できることを確認済みです。暗号化されているため、データの安全性も確保されています。

**Q3: ウイルス対策は本当に有効なのか？**

**A**: はい。3種類のウイルス対策ソフトで毎日自動チェックしています。異常があれば自動でアラートが発火するため、すぐに対応できます。実際のテストでも正常に動作することを確認済みです。

**Q4: コストはどのくらいかかるのか？**

**A**: ほぼゼロ円です。すべて無料のソフトウェアを使用しているため、追加の費用はかかりません。

**Q5: ログの機密情報保護とは何か？**

**A**: ログファイルに認証キーなどの機密情報が平文で出力されないようにする対策です。2026年1月18日に実装を完了し、ログ出力時に自動的に機密情報を`[REDACTED]`に置換するようにしました。これにより、ログファイルが漏洩しても、認証キーが悪用されるリスクを大幅に低減できます。

---

## スライド17: 参考資料

### 関連ドキュメント

- [セキュリティ要件定義](../security/requirements.md)
- [セキュリティ実装の妥当性評価](../security/implementation-assessment.md)
- [セキュリティ強化計画](../plans/security-hardening-execplan.md)
- [ログの機密情報保護実装レポート](../security/log-redaction-implementation.md)
- [緊急に実装すべき安全対策機能](../security/urgent-security-measures.md)
- [セキュリティ評価報告書](../security/evaluation-report.md)
- [ナレッジベース](../knowledge-base/index.md)

### 外部リソース

- IPA（情報処理推進機構）: [ランサムウェア対策ガイドライン](https://www.ipa.go.jp/security/anshin/measures/ransom_tokusetsu.html)
- アサヒビールの被害事例: ITmedia記事（2025年9月29日）

### お問い合わせ

システム担当者までお気軽にお問い合わせください。

---

## 付録: 詳細な技術情報

### 実装済みのセキュリティ対策の詳細

#### 1. ファイアウォール（UFW）
- HTTP/HTTPS（80/443）のみ許可
- SSHは信頼ネットワークのみ（192.168.10.0/24、100.64.0.0/10）
- VNCはローカルネットワークのみ（192.168.10.0/24、192.168.128.0/24）

#### 2. HTTPS強制（Caddy）
- HTTPアクセスを自動的にHTTPSにリダイレクト
- 自己署名証明書を使用（ローカルネットワーク環境）

#### 3. 侵入検知（fail2ban）
- SSHとCaddy HTTP認証のブルートフォース攻撃を検知
- 自動的にIPアドレスを遮断（1時間）
- アラートを自動生成

#### 4. マルウェアスキャン
- **ClamAV**: ウイルス・マルウェア検出（日次スキャン）
- **Trivy**: 脆弱性スキャン（日次スキャン）
- **rkhunter**: ルートキット検出（日次スキャン）
- 検知時に自動アラートを生成

#### 5. バックアップと復旧
- GPG暗号化によるバックアップ
- 検証用DBでの復元テスト実施済み
- オフライン保存対応（USBメディア）

#### 6. 監視・アラート
- fail2ban Banイベントの自動監視（15分間隔）
- マルウェアスキャン結果の自動アラート化
- 管理画面でのアラート表示

#### 7. ログの機密情報保護（2026-01-18追加）
- 認証キー（`x-client-key`）をログから除外
- ログ出力時に自動的に`[REDACTED]`に置換
- ログファイル漏洩時のリスクを低減
- 実装箇所: リクエストロガー、キオスクAPI、工具管理API、WebRTCシグナリングなど6箇所

---

**資料作成日**: 2025年12月5日  
**最終更新**: 2026年1月19日

### 最新の更新内容（2026-01-19）

#### ✅ ログの機密情報保護機能を実装完了

**何を実装したか**:
- 認証キー（`x-client-key`）がログに平文で出力されていた問題を修正
- ログ出力時に認証キーを`[REDACTED]`に置換するように実装

**なぜ重要か**:
- ログファイルが漏洩した場合、認証キーが悪用され、キオスクAPIへの不正アクセスが可能になる
- セキュリティ評価で中優先度だが影響が大きい脆弱性として特定された

**どこを修正したか**:
- リクエストロガー（`request-logger.ts`）
- キオスクAPI（`kiosk.ts`）
- 工具管理API（`tools/loans/cancel.ts`、`return.ts`、`delete.ts`）
- WebRTCシグナリング（`webrtc/signaling.ts`）

**検証結果**:
- ✅ CIテスト成功（GitHub Actions）
- ✅ デプロイ成功（Pi5）
- ✅ ログ確認完了（`x-client-key`が`[REDACTED]`として出力されることを確認）

**今後の予定**:
- デフォルトパスワードの変更（本番環境では必須）
- USBメモリへのバックアップテスト
- CSRF対策の実装
- PostgreSQL SSL/TLS接続の強制

**詳細情報**:
- [ログの機密情報保護実装レポート](../security/log-redaction-implementation.md)
- [緊急に実装すべき安全対策機能](../security/urgent-security-measures.md)
- [セキュリティ評価報告書](../security/evaluation-report.md)

