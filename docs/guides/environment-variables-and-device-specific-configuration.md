# ç’°å¢ƒå¤‰æ•°ã¨ãƒ‡ãƒã‚¤ã‚¹å›ºæœ‰è¨­å®šã®ç®¡ç†ã‚¬ã‚¤ãƒ‰

æœ€çµ‚æ›´æ–°: 2025-12-18

## æ¦‚è¦

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Raspberry Piã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹ç’°å¢ƒå¤‰æ•°ã¨ãƒ‡ãƒã‚¤ã‚¹å›ºæœ‰è¨­å®šã®ç®¡ç†æ–¹æ³•ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ é‡è¦ãªåŸå‰‡

### 1. ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«ç½®ã‹ãªã„æƒ…å ±

ä»¥ä¸‹ã®æƒ…å ±ã¯**ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªï¼ˆGitHubï¼‰ã«ã¯ç½®ãã¾ã›ã‚“**ã€‚å„ãƒ‡ãƒã‚¤ã‚¹ï¼ˆPi5ã€Pi3ã€Pi4ï¼‰ã«ã®ã¿å­˜åœ¨ã—ã¾ã™ï¼š

- **æ©Ÿå¯†æƒ…å ±**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€APIã‚­ãƒ¼ã€ãƒˆãƒ¼ã‚¯ãƒ³ãªã©
- **ãƒ‡ãƒã‚¤ã‚¹å›ºæœ‰ã®è¨­å®š**: IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ãªã©
- **æœ¬ç•ªç’°å¢ƒã®ç’°å¢ƒå¤‰æ•°**: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.env.example`ã¯ãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œã‚‹ï¼‰

### 2. ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«ç½®ãæƒ…å ±

ä»¥ä¸‹ã®æƒ…å ±ã¯**ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œã¾ã™**ï¼š

- **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `.env.example`ã€Ansibleãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆ`.j2`ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤**: é–‹ç™ºç’°å¢ƒç”¨ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
- **è¨­å®šã®æ§‹é€ **: ã©ã®ç’°å¢ƒå¤‰æ•°ãŒå¿…è¦ã‹ã€ã©ã®ã‚ˆã†ãªå½¢å¼ã‹

## ğŸ” ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†æ–¹æ³•

### ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡

ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½¿ç”¨ã•ã‚Œã¾ã™ï¼š

| ãƒ•ã‚¡ã‚¤ãƒ« | å ´æ‰€ | ç”¨é€” | ãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œã‚‹ã‹ |
|---------|------|------|---------------------|
| `apps/api/.env` | Pi5ä¸Š | APIã‚µãƒ¼ãƒãƒ¼ã®ç’°å¢ƒå¤‰æ•° | âŒ å«ã¾ã‚Œãªã„ï¼ˆ`.env.example`ã¯å«ã¾ã‚Œã‚‹ï¼‰ |
| `apps/web/.env` | Pi5ä¸Š | Webã‚µãƒ¼ãƒãƒ¼ã®ç’°å¢ƒå¤‰æ•° | âŒ å«ã¾ã‚Œãªã„ï¼ˆ`.env.example`ã¯å«ã¾ã‚Œã‚‹ï¼‰ |
| `infrastructure/docker/.env` | Pi5ä¸Š | Docker Composeã®ç’°å¢ƒå¤‰æ•° | âŒ å«ã¾ã‚Œãªã„ |
| `clients/nfc-agent/.env` | Pi4ä¸Š | NFCã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç’°å¢ƒå¤‰æ•° | âŒ å«ã¾ã‚Œãªã„ï¼ˆ`.env.example`ã¯å«ã¾ã‚Œã‚‹ï¼‰ |

### æ–°ã—ã„Pi5ã§ç’°å¢ƒæ§‹ç¯‰ã™ã‚‹éš›ã®æ‰‹é †

#### ã‚¹ãƒ†ãƒƒãƒ—1: ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
# Pi5ä¸Šã§å®Ÿè¡Œ
cd /opt
git clone https://github.com/denkoushi/RaspberryPiSystem_002.git RaspberryPiSystem_002
cd RaspberryPiSystem_002
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

`.env.example`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€æœ¬ç•ªç’°å¢ƒç”¨ã®å€¤ã‚’è¨­å®šã—ã¾ã™ï¼š

```bash
# APIã®ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
cd /opt/RaspberryPiSystem_002
cp apps/api/.env.example apps/api/.env

# æœ¬ç•ªç’°å¢ƒç”¨ã®å€¤ã‚’è¨­å®šï¼ˆã‚¨ãƒ‡ã‚£ã‚¿ã§ç·¨é›†ï¼‰
nano apps/api/.env
```

**è¨­å®šã™ã¹ãä¸»ãªç’°å¢ƒå¤‰æ•°**:

```bash
# PostgreSQLãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆå¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šï¼‰
POSTGRES_PASSWORD="your-strong-password-here"

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹URLï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—ï¼‰
DATABASE_URL="postgresql://postgres:${POSTGRES_PASSWORD}@db:5432/borrow_return"

# JWTã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆå¼·åŠ›ãªãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—ã‚’è¨­å®šï¼‰
JWT_ACCESS_SECRET="your-access-secret-here"
JWT_REFRESH_SECRET="your-refresh-secret-here"
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: Docker Composeã®ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

```bash
# Docker Composeã®ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
# æ³¨æ„: docker-compose.server.ymlã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆinfrastructure/docker/ï¼‰ã«ä½œæˆ
cd /opt/RaspberryPiSystem_002/infrastructure/docker
cat > .env <<EOF
# PostgreSQLãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆå¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šï¼‰
POSTGRES_PASSWORD=your-strong-password-here
EOF

# ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’è¨­å®šï¼ˆæ‰€æœ‰è€…ã®ã¿èª­ã¿æ›¸ãå¯èƒ½ï¼‰
chmod 600 .env
chmod 600 ../../apps/api/.env
```

**é‡è¦**: `docker-compose.server.yml`ã¯`infrastructure/docker/.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•çš„ã«èª­ã¿è¾¼ã¿ã¾ã™ï¼ˆ`env_file: - .env`ã§æŒ‡å®šï¼‰ã€‚

#### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•

```bash
# å¼·åŠ›ãªãƒ©ãƒ³ãƒ€ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
openssl rand -base64 32

# ã¾ãŸã¯ã€è¤‡æ•°ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¿…è¦ãªå ´åˆ
for i in {1..3}; do
  echo "Password $i: $(openssl rand -base64 32)"
done
```

#### ã‚¹ãƒ†ãƒƒãƒ—5: Docker Composeã§ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã‚€

`docker-compose.server.yml`ã¯`infrastructure/docker/.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•çš„ã«èª­ã¿è¾¼ã¿ã¾ã™ï¼ˆ`env_file: - .env`ã§æŒ‡å®šï¼‰ã€‚

**ç¢ºèªæ–¹æ³•**:

```bash
# Docker Composeã§ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
cd /opt/RaspberryPiSystem_002
docker compose -f infrastructure/docker/docker-compose.server.yml config | grep POSTGRES_PASSWORD

# å®Ÿéš›ã®å€¤ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®postgresã§ã¯ãªãã€è¨­å®šã—ãŸå€¤ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼‰
```

### Ansibleã«ã‚ˆã‚‹ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†ï¼ˆæ¨å¥¨ï¼‰

Ansibleã‚’ä½¿ç”¨ã—ã¦ç’°å¢ƒå¤‰æ•°ã‚’ç®¡ç†ã™ã‚‹å ´åˆã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.j2`ï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

#### Ansibleãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å ´æ‰€

```
infrastructure/ansible/roles/server/templates/
â”œâ”€â”€ api.env.j2          # APIã®ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”œâ”€â”€ web.env.j2          # Webã®ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”œâ”€â”€ docker.env.j2       # Docker Composeã®ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â””â”€â”€ nfc-agent.env.j2    # NFCã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```

#### Ansibleã§ç’°å¢ƒå¤‰æ•°ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•

```bash
# Macã‹ã‚‰å®Ÿè¡Œ
cd /path/to/RaspberryPiSystem_002
ansible-playbook infrastructure/ansible/playbooks/manage-app-configs.yml
```

**Ansibleãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®åˆ©ç‚¹**:
- ç’°å¢ƒå¤‰æ•°ã®æ§‹é€ ã‚’ä¸€å…ƒç®¡ç†ã§ãã‚‹
- ãƒ‡ãƒã‚¤ã‚¹ã”ã¨ã«ç•°ãªã‚‹å€¤ã‚’è¨­å®šã§ãã‚‹
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãŒå¯èƒ½ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œã‚‹ï¼‰

**æ³¨æ„**: Ansibleãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¯å®Ÿéš›ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å«ã‚ã¾ã›ã‚“ã€‚Ansible Vaultã‚’ä½¿ç”¨ã—ã¦æš—å·åŒ–ã™ã‚‹ã‹ã€ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«ç’°å¢ƒå¤‰æ•°ã§ä¸Šæ›¸ãã—ã¾ã™ã€‚

## ğŸ–¥ï¸ ãƒ‡ãƒã‚¤ã‚¹å›ºæœ‰è¨­å®šã®ç®¡ç†

### Pi5ï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰ã«ã®ã¿å­˜åœ¨ã™ã‚‹æƒ…å ±

| æƒ…å ±ã®ç¨®é¡ | å ´æ‰€ | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå¿…è¦ã‹ | ç®¡ç†æ–¹æ³• |
|-----------|------|-------------------|---------|
| **ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«** | `apps/api/.env`, `apps/web/.env`, `infrastructure/docker/.env` | âœ… **å¿…é ˆ** | `.env.example`ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½œæˆã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |
| **è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«** | `/opt/RaspberryPiSystem_002/certs/` | âœ… **å¿…é ˆ** | è‡ªå·±ç½²åè¨¼æ˜æ›¸ã‚’ç”Ÿæˆã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |
| **IPã‚¢ãƒ‰ãƒ¬ã‚¹è¨­å®š** | `infrastructure/ansible/group_vars/all.yml` | âš ï¸ **æ¨å¥¨** | Ansibleå¤‰æ•°ã§ç®¡ç†ã€ãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œã‚‹ï¼ˆãƒ‡ãƒã‚¤ã‚¹ã”ã¨ã«ç•°ãªã‚‹å€¤ï¼‰ |
| **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹** | Dockerãƒœãƒªãƒ¥ãƒ¼ãƒ  `db-data` | âœ… **å¿…é ˆ** | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |
| **å†™çœŸãƒ»PDFãƒ•ã‚¡ã‚¤ãƒ«** | `/opt/RaspberryPiSystem_002/storage/` | âœ… **å¿…é ˆ** | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |

### Pi4ï¼ˆã‚­ã‚ªã‚¹ã‚¯ï¼‰ã«ã®ã¿å­˜åœ¨ã™ã‚‹æƒ…å ±

| æƒ…å ±ã®ç¨®é¡ | å ´æ‰€ | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå¿…è¦ã‹ | ç®¡ç†æ–¹æ³• |
|-----------|------|-------------------|---------|
| **ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«** | `clients/nfc-agent/.env` | âš ï¸ **æ¨å¥¨** | `.env.example`ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½œæˆã€Ansibleã§ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ |
| **NFCãƒªãƒ¼ãƒ€ãƒ¼è¨­å®š** | ã‚·ã‚¹ãƒ†ãƒ è¨­å®š | âŒ ä¸è¦ | ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢è¨­å®šã€å†è¨­å®šå¯èƒ½ |

### Pi3ï¼ˆã‚µã‚¤ãƒãƒ¼ã‚¸ï¼‰ã«ã®ã¿å­˜åœ¨ã™ã‚‹æƒ…å ±

| æƒ…å ±ã®ç¨®é¡ | å ´æ‰€ | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå¿…è¦ã‹ | ç®¡ç†æ–¹æ³• |
|-----------|------|-------------------|---------|
| **ãƒ–ãƒ©ã‚¦ã‚¶è¨­å®š** | Chromiumè¨­å®š | âŒ ä¸è¦ | å†è¨­å®šå¯èƒ½ |

## ğŸ’¾ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®å¿…è¦æ€§ã¨æ–¹æ³•

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå¿…è¦ãªæƒ…å ±

#### ğŸ”´ å¿…é ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆå¤±ã†ã¨å¾©æ—§å›°é›£ï¼‰

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆPostgreSQLï¼‰**
   - **å ´æ‰€**: Dockerãƒœãƒªãƒ¥ãƒ¼ãƒ  `db-data`
   - **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ–¹æ³•**: `scripts/server/backup.sh`ã§è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
   - **é »åº¦**: æ—¥æ¬¡ï¼ˆæ¨å¥¨ï¼‰
   - **ä¿å­˜å…ˆ**: `/opt/backups/`

2. **ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«**
   - **å ´æ‰€**: `apps/api/.env`, `apps/web/.env`, `infrastructure/docker/.env`
   - **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ–¹æ³•**: `scripts/server/backup.sh`ã§è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
   - **é »åº¦**: å¤‰æ›´æ™‚ï¼ˆè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å«ã¾ã‚Œã‚‹ï¼‰
   - **ä¿å­˜å…ˆ**: `/opt/backups/`

3. **è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«**
   - **å ´æ‰€**: `/opt/RaspberryPiSystem_002/certs/`
   - **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ–¹æ³•**: æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼
   - **é »åº¦**: è¨¼æ˜æ›¸ç”Ÿæˆæ™‚ï¼ˆä¸€åº¦ã ã‘ï¼‰
   - **ä¿å­˜å…ˆ**: USBãƒ¡ãƒ‡ã‚£ã‚¢ã¾ãŸã¯å®‰å…¨ãªå ´æ‰€

4. **å†™çœŸãƒ»PDFãƒ•ã‚¡ã‚¤ãƒ«**
   - **å ´æ‰€**: `/opt/RaspberryPiSystem_002/storage/photos`, `/opt/RaspberryPiSystem_002/storage/pdfs`
   - **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ–¹æ³•**: `scripts/server/backup.sh`ã§è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
   - **é »åº¦**: æ—¥æ¬¡ï¼ˆæ¨å¥¨ï¼‰
   - **ä¿å­˜å…ˆ**: `/opt/backups/`

#### ğŸŸ¡ æ¨å¥¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆå¤±ã£ã¦ã‚‚å†è¨­å®šå¯èƒ½ã ãŒæ™‚é–“ãŒã‹ã‹ã‚‹ï¼‰

1. **IPã‚¢ãƒ‰ãƒ¬ã‚¹è¨­å®š**
   - **å ´æ‰€**: `infrastructure/ansible/group_vars/all.yml`
   - **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ–¹æ³•**: ãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œã‚‹ãŸã‚ã€Gitã§ç®¡ç†
   - **é »åº¦**: å¤‰æ›´æ™‚ï¼ˆGitã‚³ãƒŸãƒƒãƒˆï¼‰
   - **æ³¨æ„**: ãƒ‡ãƒã‚¤ã‚¹ã”ã¨ã«ç•°ãªã‚‹å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æ–°ã—ã„ãƒ‡ãƒã‚¤ã‚¹ã§ã¯å†è¨­å®šãŒå¿…è¦

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½¿ç”¨æ–¹æ³•

```bash
# Pi5ä¸Šã§å®Ÿè¡Œ
cd /opt/RaspberryPiSystem_002
./scripts/server/backup.sh
```

**ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã•ã‚Œã‚‹å†…å®¹**:
- PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆ`db_backup_YYYYMMDD_HHMMSS.sql.gz`ï¼‰
- ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`api_env_YYYYMMDD_HHMMSS.env`, `web_env_YYYYMMDD_HHMMSS.env`ï¼‰
- å†™çœŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ`photos_backup_YYYYMMDD_HHMMSS.tar.gz`ï¼‰

**ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ä¿å­˜å ´æ‰€**: `/opt/backups/`

**ä¿æŒæœŸé–“**: 30æ—¥ï¼ˆ30æ—¥ä»¥ä¸Šå‰ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯è‡ªå‹•å‰Šé™¤ï¼‰

### è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å«ã¾ã‚Œã¦ã„ãªã„ãŸã‚ã€æ‰‹å‹•ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

```bash
# Pi5ä¸Šã§å®Ÿè¡Œ
# è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
tar -czf /opt/backups/certs_backup_$(date +%Y%m%d_%H%M%S).tar.gz -C /opt/RaspberryPiSystem_002 certs/

# USBãƒ¡ãƒ‡ã‚£ã‚¢ã«ã‚³ãƒ”ãƒ¼ï¼ˆUSBãƒ¡ãƒ‡ã‚£ã‚¢ãŒãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰
# sudo mount /dev/sda1 /mnt/usb
# cp /opt/backups/certs_backup_*.tar.gz /mnt/usb/
# sudo umount /mnt/usb
```

## ğŸ”„ æ–°ã—ã„Pi5ã§ç’°å¢ƒæ§‹ç¯‰ã™ã‚‹éš›ã®å®Œå…¨ãªæ‰‹é †

### äº‹å‰æº–å‚™ï¼ˆMacä¸Šã§å®Ÿè¡Œï¼‰

1. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æº–å‚™**
   - æ—¢å­˜ã®Pi5ã‹ã‚‰ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
   - ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.env`ï¼‰ã‚’ã‚³ãƒ”ãƒ¼
   - è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`certs/`ï¼‰ã‚’ã‚³ãƒ”ãƒ¼

### Pi5ã§ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### 1. åŸºæœ¬ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# OSã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆRaspberry Pi Imagerã‚’ä½¿ç”¨ï¼‰
# Dockerã€Gitã€Node.jsã€pnpmã€Pythonã€Poetryã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# ï¼ˆè©³ç´°ã¯ production-setup.md ã‚’å‚ç…§ï¼‰
```

#### 2. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
cd /opt
git clone https://github.com/denkoushi/RaspberryPiSystem_002.git RaspberryPiSystem_002
cd RaspberryPiSystem_002
```

#### 3. ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

```bash
# .env.exampleã‚’ã‚³ãƒ”ãƒ¼ã—ã¦.envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
cp apps/api/.env.example apps/api/.env
cp infrastructure/docker/.env.example infrastructure/docker/.env 2>/dev/null || true

# æœ¬ç•ªç’°å¢ƒç”¨ã®å€¤ã‚’è¨­å®šï¼ˆã‚¨ãƒ‡ã‚£ã‚¿ã§ç·¨é›†ï¼‰
nano apps/api/.env
nano infrastructure/docker/.env
```

**è¨­å®šã™ã¹ãå€¤**:
- `POSTGRES_PASSWORD`: å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆæ—¢å­˜ã®Pi5ã‹ã‚‰å–å¾—ã—ãŸå€¤ã€ã¾ãŸã¯æ–°è¦ç”Ÿæˆï¼‰
- `JWT_ACCESS_SECRET`: å¼·åŠ›ãªãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—
- `JWT_REFRESH_SECRET`: å¼·åŠ›ãªãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—
- `DATABASE_URL`: `postgresql://postgres:${POSTGRES_PASSWORD}@db:5432/borrow_return`

#### 4. è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã®é…ç½®

```bash
# è¨¼æ˜æ›¸ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
sudo mkdir -p /opt/RaspberryPiSystem_002/certs

# æ—¢å­˜ã®Pi5ã‹ã‚‰è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆã¾ãŸã¯æ–°è¦ç”Ÿæˆï¼‰
# æ—¢å­˜ã®Pi5ã‹ã‚‰:
# scp denkon5sd02@100.106.158.2:/opt/RaspberryPiSystem_002/certs/* /opt/RaspberryPiSystem_002/certs/

# ã¾ãŸã¯æ–°è¦ç”Ÿæˆ:
cd /opt/RaspberryPiSystem_002/certs
sudo openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 3650 -nodes \
  -subj "/C=JP/ST=Tokyo/L=Tokyo/O=Factory/CN=raspberrypi.local"
sudo chmod 644 cert.pem
sudo chmod 600 key.pem
sudo chown $USER:$USER cert.pem key.pem
```

#### 5. IPã‚¢ãƒ‰ãƒ¬ã‚¹è¨­å®šã®æ›´æ–°

```bash
# group_vars/all.ymlã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ–°ã—ã„Pi5ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«æ›´æ–°
nano infrastructure/ansible/group_vars/all.yml

# ç¾åœ¨ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèª
hostname -I

# local_network.raspberrypi5_ip ã‚’æ–°ã—ã„IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«æ›´æ–°
# tailscale_network.raspberrypi5_ip ã‚’Tailscale IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«æ›´æ–°ï¼ˆTailscaleã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼‰
```

#### 6. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ãƒ“ãƒ«ãƒ‰

```bash
cd /opt/RaspberryPiSystem_002
pnpm install
cd packages/shared-types && pnpm build && cd ../..
cd apps/api && pnpm prisma generate && cd ../..
```

#### 7. Docker Composeã®èµ·å‹•

```bash
cd /opt/RaspberryPiSystem_002
docker compose -f infrastructure/docker/docker-compose.server.yml up -d
```

#### 8. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒªã‚¹ãƒˆã‚¢ï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆï¼‰

```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒªã‚¹ãƒˆã‚¢
cd /opt/RaspberryPiSystem_002
./scripts/server/restore.sh /opt/backups/db_backup_YYYYMMDD_HHMMSS.sql.gz
```

#### 9. å‹•ä½œç¢ºèª

```bash
# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
curl -k https://localhost/api/system/health

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª
docker compose -f infrastructure/docker/docker-compose.server.yml exec db \
  psql -U postgres -d borrow_return -c "SELECT COUNT(*) FROM \"Loan\";"
```

## ğŸ“ ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ç”Ÿæˆã¨ç®¡ç†

```bash
# å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
openssl rand -base64 32

# ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å®‰å…¨ã«ä¿å­˜
# - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’ä½¿ç”¨
# - Ansible Vaultã‚’ä½¿ç”¨ï¼ˆAnsibleã§ç®¡ç†ã™ã‚‹å ´åˆï¼‰
# - æš—å·åŒ–ã•ã‚ŒãŸUSBãƒ¡ãƒ‡ã‚£ã‚¢ã«ä¿å­˜
```

### 2. ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿è­·

```bash
# ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’è¨­å®šï¼ˆæ‰€æœ‰è€…ã®ã¿èª­ã¿æ›¸ãå¯èƒ½ï¼‰
chmod 600 apps/api/.env
chmod 600 infrastructure/docker/.env

# .gitignoreã«.envãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
grep -q "\.env$" .gitignore && echo "OK" || echo "WARNING: .env not in .gitignore"
```

### 3. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®å®šæœŸå®Ÿè¡Œ

```bash
# cronã§å®šæœŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’è¨­å®š
crontab -e

# æ¯æ—¥åˆå‰3æ™‚ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œ
0 3 * * * /opt/RaspberryPiSystem_002/scripts/server/backup.sh
```

### 4. ç’°å¢ƒå¤‰æ•°ã®å¤‰æ›´æ™‚ã®å¯¾å¿œ

ç’°å¢ƒå¤‰æ•°ã‚’å¤‰æ›´ã—ãŸå ´åˆï¼š

1. **å¤‰æ›´ã‚’è¨˜éŒ²**: å¤‰æ›´å†…å®¹ã‚’ãƒ¡ãƒ¢ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãªã©ï¼‰
2. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œ**: `./scripts/server/backup.sh`ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
3. **Docker Composeã‚’å†èµ·å‹•**: ç’°å¢ƒå¤‰æ•°ã®å¤‰æ›´ã‚’åæ˜ 
   ```bash
   docker compose -f infrastructure/docker/docker-compose.server.yml down
   docker compose -f infrastructure/docker/docker-compose.server.yml up -d
   ```

## ğŸ” ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰

### Q1: æ–°ã—ã„Pi5ã§ç’°å¢ƒæ§‹ç¯‰ã™ã‚‹éš›ã€æ—¢å­˜ã®Pi5ã‹ã‚‰ä½•ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚Œã°è‰¯ã„ï¼Ÿ

**A**: ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ï¼š

1. **ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«**ï¼ˆ`.env`ï¼‰
   ```bash
   # æ—¢å­˜ã®Pi5ã‹ã‚‰ã‚³ãƒ”ãƒ¼
   # æ³¨æ„: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ã®æ©Ÿå¯†æƒ…å ±ãŒå«ã¾ã‚Œã‚‹ãŸã‚ã€å®‰å…¨ãªæ–¹æ³•ã§ã‚³ãƒ”ãƒ¼ã™ã‚‹ã“ã¨
   scp denkon5sd02@100.106.158.2:/opt/RaspberryPiSystem_002/apps/api/.env /opt/RaspberryPiSystem_002/apps/api/.env
   scp denkon5sd02@100.106.158.2:/opt/RaspberryPiSystem_002/infrastructure/docker/.env /opt/RaspberryPiSystem_002/infrastructure/docker/.env
   
   # ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’è¨­å®š
   chmod 600 /opt/RaspberryPiSystem_002/apps/api/.env
   chmod 600 /opt/RaspberryPiSystem_002/infrastructure/docker/.env
   ```

2. **è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«**ï¼ˆ`certs/`ï¼‰
   ```bash
   # æ—¢å­˜ã®Pi5ã‹ã‚‰ã‚³ãƒ”ãƒ¼
   scp -r denkon5sd02@100.106.158.2:/opt/RaspberryPiSystem_002/certs /opt/RaspberryPiSystem_002/
   
   # ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’è¨­å®š
   sudo chmod 644 /opt/RaspberryPiSystem_002/certs/cert.pem
   sudo chmod 600 /opt/RaspberryPiSystem_002/certs/key.pem
   ```

3. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**ï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã™ã‚‹å ´åˆï¼‰
   ```bash
   # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
   mkdir -p /opt/backups
   
   # æ—¢å­˜ã®Pi5ã‹ã‚‰æœ€æ–°ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ã‚³ãƒ”ãƒ¼
   scp denkon5sd02@100.106.158.2:/opt/backups/db_backup_*.sql.gz /opt/backups/
   ```

### Q2: ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œãªã„ã®ã«ã€ã©ã†ã‚„ã£ã¦ç®¡ç†ã™ã‚‹ï¼Ÿ

**A**: ä»¥ä¸‹ã®æ–¹æ³•ã§ç®¡ç†ã—ã¾ã™ï¼š

1. **`.env.example`ãƒ•ã‚¡ã‚¤ãƒ«**: ãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
2. **æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼**: `.env.example`ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦`.env`ã‚’ä½œæˆã—ã€æœ¬ç•ªç’°å¢ƒç”¨ã®å€¤ã‚’è¨­å®š
3. **Ansibleãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**: Ansibleã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€`.j2`ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç”Ÿæˆ
4. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

### Q3: Pi5ã€Pi3ã€Pi4ã«ã ã‘ç½®ã„ã¦ã‚ã‚‹æƒ…å ±ã§ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå¿…è¦ãªã‚‚ã®ã¯ï¼Ÿ

**A**: ä»¥ä¸‹ã®æƒ…å ±ã¯ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå¿…è¦ã§ã™ï¼š

**Pi5ï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰**:
- âœ… ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.env`ï¼‰- **å¿…é ˆ**
- âœ… è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`certs/`ï¼‰- **å¿…é ˆ**
- âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆPostgreSQLï¼‰- **å¿…é ˆ**
- âœ… å†™çœŸãƒ»PDFãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`storage/`ï¼‰- **å¿…é ˆ**
- âš ï¸ IPã‚¢ãƒ‰ãƒ¬ã‚¹è¨­å®šï¼ˆ`group_vars/all.yml`ï¼‰- **æ¨å¥¨**ï¼ˆãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œã‚‹ãŒã€ãƒ‡ãƒã‚¤ã‚¹ã”ã¨ã«ç•°ãªã‚‹å€¤ï¼‰

**Pi4ï¼ˆã‚­ã‚ªã‚¹ã‚¯ï¼‰**:
- âš ï¸ ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`clients/nfc-agent/.env`ï¼‰- **æ¨å¥¨**ï¼ˆå†è¨­å®šå¯èƒ½ï¼‰

**Pi3ï¼ˆã‚µã‚¤ãƒãƒ¼ã‚¸ï¼‰**:
- âŒ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¸è¦ï¼ˆå†è¨­å®šå¯èƒ½ï¼‰

### Q4: ç’°å¢ƒå¤‰æ•°ã‚’å¤‰æ›´ã—ãŸå¾Œã€ã©ã†ã‚„ã£ã¦åæ˜ ã•ã›ã‚‹ï¼Ÿ

**A**: Docker Composeã‚’å†èµ·å‹•ã—ã¾ã™ï¼š

```bash
cd /opt/RaspberryPiSystem_002
docker compose -f infrastructure/docker/docker-compose.server.yml down
docker compose -f infrastructure/docker/docker-compose.server.yml up -d
```

### Q5: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸå ´åˆã€ã©ã†ã™ã‚Œã°è‰¯ã„ï¼Ÿ

**A**: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒã—ã¾ã™ï¼š

```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
ls -la /opt/backups/*.env

# æœ€æ–°ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ
cp /opt/backups/api_env_YYYYMMDD_HHMMSS.env /opt/RaspberryPiSystem_002/apps/api/.env
cp /opt/backups/docker_env_YYYYMMDD_HHMMSS.env /opt/RaspberryPiSystem_002/infrastructure/docker/.env

# Docker Composeã‚’å†èµ·å‹•
docker compose -f infrastructure/docker/docker-compose.server.yml down
docker compose -f infrastructure/docker/docker-compose.server.yml up -d
```

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰](./deployment.md) - ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ã®è©³ç´°
- [æœ¬ç•ªç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰](./production-setup.md) - åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †
- [ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ãƒªã‚¹ãƒˆã‚¢æ‰‹é †](./backup-and-restore.md) - ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ãƒªã‚¹ãƒˆã‚¢ã®è©³ç´°
- [PostgreSQLãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒªã‚·ãƒ¼å¼·åŒ–ã®å®Ÿè£…](../security/postgresql-password-policy-implementation.md) - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç®¡ç†ã®å®Ÿè£…è©³ç´°
