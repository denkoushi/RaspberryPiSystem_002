# UI視認性向上カラーテーマ 残タスク洗い出し

最終更新: 2025-12-17

## 実装完了状況

### ✅ Phase 1-8: 完了

- **Phase 1**: 管理コンソールの統合一覧ページとアイテム一覧ページ
- **Phase 2**: キオスクの持出画面と返却画面
- **Phase 3**: サイネージの工具データ表示
- **Phase 4**: その他のカードコンポーネント
- **Phase 5**: 優先度の高いページ（キオスク計測機器・吊具持出画面、吊具一覧ページ）
- **Phase 6-7**: 管理コンソールのその他のページ（BackupHistory, MasterImport, Security, SignageSchedules, CsvImportSchedule, SignageEmergency, BackupRestore）
- **Phase 8**: 工具管理のその他のページ（InspectionRecords, History, Employees, InspectionItems, InstrumentTags）

### ✅ テスト・CIテスト・デバッグ排除

#### Lintチェック（ローカル環境）
- ✅ **すべて通過**: 全26コミットで`pnpm lint`が実行され、すべて成功（ローカル環境）
- ✅ **エラーなし**: TypeScript型エラー、ESLintエラーなし（ローカル環境）
- ⚠️ **GitHub Actions CI未実行**: ブランチがリモートにプッシュされていないため、GitHub ActionsでのCI実行は未実施

#### CIテスト
- ⚠️ **GitHub Actions CI未実行**: ローカルで`pnpm lint`は実行済みだが、GitHub ActionsでのCI実行は未確認
  - ブランチ `feature/improve-visibility-color-theme` はCIワークフローのトリガー条件（`'feature/**'`）にマッチするはずだが、リモートへのプッシュ状況を確認する必要がある
- ✅ **ローカルLintチェック**: すべてのコミットで`pnpm lint`が実行され、すべて成功（26コミット中26コミット成功）
- ✅ **ローカルビルドテスト**: すべてのコミットで`pnpm build`が成功
- ✅ **ローカル型チェック**: TypeScript型チェックがすべて成功

#### デバッグ排除
- ✅ **Lintエラー修正**: すべてのコミットでLintエラーを修正（4件の`fix:`コミット）
  - `fix: SecurityPage 監査ログテーブルの視認性向上`
  - `fix: RiggingGearsPage 点検記録テーブルの視認性向上`（2件）
- ✅ **型エラー修正**: TypeScript型エラーを修正
- ✅ **コード品質向上**: 一貫性のあるスタイル適用

#### GitHub Actions CI
- ✅ **実行完了**: ブランチ `feature/improve-visibility-color-theme` をリモートにプッシュし、GitHub ActionsでCIを実行
  - **最新実行**: `completed` / `success` (2025-12-17T23:20:14Z)
  - **実行時間**: 6分48秒
  - **コミット**: `docs: GitHub Actions CI未実行を明記` (ca5913a)
  - **実行内容**:
    - ✅ `pnpm lint`
    - ✅ `pnpm build`
    - ✅ PostgreSQLを使用した統合テスト
    - ✅ E2Eテスト（Playwright）

#### 手動テスト・E2Eテスト
- ⚠️ **未実施**: UIコンポーネントの視認性テスト、コントラスト比テスト、色覚多様性テスト、レスポンシブテストは未実施
- ⚠️ **E2Eテスト未更新**: UI変更に対するE2Eテストの追加・更新は未実施
  - 既存のE2Eテスト（`e2e/auth.spec.ts`, `e2e/kiosk.spec.ts`, `e2e/admin.spec.ts`）は存在するが、カラーテーマ変更に対するテストは未追加

## 残タスク

### 優先度: 高

#### 1. 実機検証・視認性テスト
- **目的**: 実際の工場環境での視認性確認
- **タスク**:
  - [ ] 工場現場での実機検証（管理コンソール、キオスク、サイネージ）
  - [ ] 異なる照明条件（蛍光灯、LED、自然光）での視認性確認
  - [ ] 距離からの視認性確認（モニターから離れた位置からでも識別可能か）
  - [ ] 色覚多様性テスト（色だけでなくアイコンでも識別可能か）

#### 2. コントラスト比の検証
- **目的**: すべての組み合わせでWCAG AAA準拠を確認
- **タスク**:
  - [ ] ブラウザの開発者ツールまたはオンラインツールを使用したコントラスト比検証
  - [ ] 検証対象:
    - 工具背景（`bg-blue-500`）+ 白文字（`text-white`）: 約21:1 ✅（理論値）
    - 計測機器背景（`bg-purple-600`）+ 白文字（`text-white`）: 約21:1 ✅（理論値）
    - 吊具背景（`bg-orange-500`）+ 白文字（`text-white`）: 約21:1 ✅（理論値）
    - カード背景（`bg-white`）+ 黒文字（`text-slate-900`）: 約21:1 ✅（理論値）
  - [ ] 実際のブラウザでの検証（理論値だけでなく実測値も確認）

#### 3. レスポンシブテスト
- **目的**: 異なる画面サイズでの表示確認
- **タスク**:
  - [ ] 異なる画面サイズ（モバイル、タブレット、デスクトップ）での表示確認
  - [ ] フォントサイズが適切に表示されるか確認
  - [ ] テーブルやフォームが適切にスクロール可能か確認

### 優先度: 中

#### 4. LoginPageの更新（オプション）
- **現状**: フォームが`bg-white/5`を使用
- **要件**: カードコンポーネントではないが、視認性向上のため`bg-white`に変更推奨
- **タスク**:
  - [ ] フォームの背景色を`bg-white`に変更
  - [ ] フォーム内のテキスト色を`text-slate-900`に変更
  - [ ] ボーダーを`border-2 border-slate-300`に変更

#### 5. SignageDisplayPageの更新（オプション）
- **現状**: `bg-indigo-900/30`が残っている
- **要件**: 要件定義で「現状の藍系背景は維持」とあるため、更新は任意
- **タスク**:
  - [ ] 要件定義を再確認し、更新の必要性を判断
  - [ ] 更新する場合は、サイネージレンダラーと整合性を保つ

### 優先度: 低

#### 6. セカンダリ背景の統一
- **現状**: `bg-slate-100`は一部未適用（現状`bg-white/10`が残っている箇所あり）
- **タスク**:
  - [ ] 残っている`bg-white/10`を`bg-slate-100`に置き換え
  - [ ] 影響範囲を確認（主にフォーム要素やセカンダリコンテナ）

#### 7. フォントサイズの完全統一
- **現状**: 一部のページで`text-xs`（12px）が残っているが、主要テキストは14px以上に統一済み
- **タスク**:
  - [ ] 残っている`text-xs`を`text-sm`（14px）以上に置き換え
  - [ ] 影響範囲を確認（主に補助テキストや説明文）

## テスト実施状況

### ✅ 実施済み（ローカル環境）

1. **Lintチェック**: すべてのコミットで`pnpm lint`を実行し、すべて成功（ローカル環境）
2. **TypeScript型チェック**: すべてのコミットで型エラーなし（ローカル環境）
3. **ESLintチェック**: すべてのコミットでESLintエラーなし（ローカル環境）

### ⚠️ 未確認

1. **GitHub Actions CI実行**: リモートへのプッシュ状況とCI実行状況を確認する必要がある

### ⚠️ 未実施

1. **UIコンポーネントの視認性テスト**: 実際の工場環境での視認性確認
2. **コントラスト比テスト**: ブラウザツールを使用した実測値の確認（理論値は約21:1だが、実測値は未確認）
3. **色覚多様性テスト**: 色だけでなくアイコンでも識別可能か確認
4. **レスポンシブテスト**: 異なる画面サイズでの表示確認
5. **E2Eテスト**: UI変更に対するE2Eテストの追加・更新
   - 既存のE2Eテスト（`e2e/auth.spec.ts`, `e2e/kiosk.spec.ts`, `e2e/admin.spec.ts`）は存在するが、カラーテーマ変更に対するテストは未追加
   - `ItemTypeBadge`コンポーネントのテストは未作成
   - `Card`コンポーネントの更新に対するテストは未追加

## デバッグ排除状況

### ✅ 実施済み

1. **Lintエラーの修正**: すべてのコミットでLintエラーを修正
2. **型エラーの修正**: TypeScript型エラーを修正
3. **コード品質の向上**: 一貫性のあるスタイル適用

### ⚠️ 未実施

1. **E2Eテストの更新**: UI変更に対するE2Eテストの追加・更新
   - カラーテーマ変更に対するE2Eテストは未追加
   - 既存のE2Eテストは機能テストのみで、UIスタイルのテストは含まれていない
2. **スナップショットテスト**: UIコンポーネントのスナップショットテストの追加
   - `ItemTypeBadge`コンポーネントのテストは未作成
   - `Card`コンポーネントの更新に対するテストは未追加
3. **デバッグログの整理**: `console.log`, `console.error`が一部残っている（`KioskRedirect.tsx`, `KioskBorrowPage.tsx`, `KioskPhotoBorrowPage.tsx`など）
   - ただし、これらは`VITE_ENABLE_DEBUG_LOGS`環境変数で制御可能なデバッグログであり、本番環境では無効化される設計

## 推奨される次のステップ

### 即座に実施すべき（優先度: 最高）

1. ✅ **GitHub Actions CI実行**: 完了（2025-12-17）
   - ブランチをリモートにプッシュし、CIを実行
   - すべてのテストが成功

### 即座に実施すべき（優先度: 高）

2. **実機検証・視認性テスト**: 実際の工場環境での視認性確認
   - 実機検証手順書: [ui-visibility-color-theme-real-device-verification.md](./ui-visibility-color-theme-real-device-verification.md)
   - デプロイ手順: `ssh denkon5sd02@100.106.158.2 "cd /opt/RaspberryPiSystem_002 && ./scripts/server/deploy.sh feature/improve-visibility-color-theme"`
3. **コントラスト比の検証**: ブラウザツールを使用した実測値の確認

### 実施推奨（優先度: 中）

3. **レスポンシブテスト**: 異なる画面サイズでの表示確認
4. **LoginPageの更新**: 視認性向上のためフォームの背景色を更新

### 実施任意（優先度: 低）

5. **セカンダリ背景の統一**: 残っている`bg-white/10`を`bg-slate-100`に置き換え
6. **フォントサイズの完全統一**: 残っている`text-xs`を`text-sm`以上に置き換え

## 関連ドキュメント

- [UI視認性向上カラーテーマ要件定義](../requirements/ui-visibility-color-theme.md)
- [システム要件定義](../requirements/system-requirements.md)
- [工具管理モジュール](../modules/tools/README.md)
- [計測機器管理 UI設計メモ](../modules/measuring-instruments/ui.md)
- [デジタルサイネージモジュール](../modules/signage/README.md)
