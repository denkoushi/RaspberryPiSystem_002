# 計測機器管理 UI設計メモ

## 持ち出しフロー（キオスク）

1. **計測機器タグスキャン画面**
   - 入力: RFID/TS100から計測機器タグUID受信
   - 表示: 計測機器名称・管理番号・保管場所・測定範囲・校正期限
   - ボタン: 「再スキャン」「キャンセル」

2. **点検項目表示・入力画面**
   - 点検項目リスト（order順）をカードで表示
   - 各項目: 内容・基準・方法を表示（テキスト/数値範囲）
   - 入力: 原則「合格」とみなし、NGの場合のみ画面右上の「NGにする」ボタンを押下
   - NGボタン: 押下すると即座にNGとして送信（個別項目の記録は不要）

3. **持ち出し登録**
   - すべて合格の場合: 氏名タグスキャン（またはUID入力）で自動送信（500msデバウンス、ボタン不要）
   - NGの場合: 「NGにする」ボタン押下で即送信
   - OKの場合は送信時に Loan + InspectionRecord（全項目PASS）を一括作成
   - NGの場合は Loan のみ作成（点検記録は作成しない）

4. **完了画面**
   - 持ち出し成功メッセージ
   - 「続けてスキャンする」ボタンでタグスキャン画面へ戻る

## 管理コンソール

- 計測機器一覧（登録/編集/削除）: `/admin/tools/measuring-instruments`
- 点検項目管理（登録/編集/削除）: `/admin/tools/inspection-items`
- RFIDタグ紐付け管理（登録/削除）: `/admin/tools/instrument-tags`
- 点検記録の閲覧/手動登録: `/admin/tools/inspection-records`
- 工具と計測機器の混在一覧・フィルタ（別途実装検討）

## サイネージ表示（ラズパイ3）

- PowerBIデザインを後続で反映
- 表示候補: 計測機器のステータス、校正期限アラート、最近の点検結果

## キオスク専用画面（ラズパイ4）

- **持ち出し画面**: `/kiosk/instruments/borrow`
  - 計測機器タグUID・氏名タグUIDの手入力フォーム（実装済み）
  - NFCエージェント連携実装済み（計測機器タグ→氏名タグの順で自動送信）
  - 計測機器選択→点検項目自動表示を実装
  - 計測機器の識別方法は「ドロップダウン選択」「タグUID入力（手入力/NFC/TS100想定）」のいずれか最初に操作した方法を採用し、以後は切り替えない（入力ソース固定）
  - OKの場合: 氏名タグUID入力またはNFCスキャンで自動送信（500msデバウンス、ボタン不要）、全項目PASSとしてInspectionRecordを作成
  - NGの場合: 「NGにする」ボタン押下で即送信、点検記録は作成しない（個別項目の記録は不要）
  - 計測機器選択後、氏名タグ入力欄に自動フォーカス
- **返却画面**: `/kiosk/instruments/return`
  - Loan ID 手入力フォーム（実装済み、TS100統合は未実装）※貸出一覧（管理コンソール/キオスク返却タブ）でID確認
  - 貸出中の計測機器リストを表示し、行から返却操作可能
- 大きなスキャン状態表示とNGボタンのみ（将来実装予定）
- ローディング/エラーを明示

## アクセシビリティ/エラーハンドリング

- スキャン失敗時のリトライ表示
- 点検項目が未取得の場合のリカバリボタン
- オフライン時はローカルキューへの保存（将来検討）