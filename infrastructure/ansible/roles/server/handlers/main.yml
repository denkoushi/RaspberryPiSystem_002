---
- name: restart api
  ansible.builtin.shell: |
    cd {{ repo_path }}/infrastructure/docker
    docker compose -f docker-compose.server.yml up -d --force-recreate api
  args:
    executable: /bin/bash

- name: restart web
  ansible.builtin.shell: |
    cd {{ repo_path }}/infrastructure/docker
    docker compose -f docker-compose.server.yml up -d --force-recreate web
  args:
    executable: /bin/bash

- name: restart docker compose services
  ansible.builtin.shell: |
    cd {{ repo_path }}/infrastructure/docker
    docker compose -f docker-compose.server.yml up -d --force-recreate api
  args:
    executable: /bin/bash
  ignore_errors: true

- name: restart fail2ban
  ansible.builtin.systemd:
    name: fail2ban
    state: restarted

- name: restart security monitor
  ansible.builtin.systemd:
    name: security-monitor.timer
    state: restarted
    enabled: true
